---
output: github_document
editor_options: 
  chunk_output_type: console
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# ShinyLipids

<!-- badges: start -->
[![Travis build status](https://travis-ci.org/jannikbuhr/shinylipids.svg?branch=master)](https://travis-ci.org/jannikbuhr/shinylipids)
<!-- badges: end -->


A remake of ShinyLipids with consistent coding, documentation and improved functionality.

## What is ShinyLipids?

ShinyLipids is a visualization tool for lipidomcis data built in R with the `shiny` package. The original
version was developed in 2015 by _Mathias Gerl_ and further enhanced by _Manuel Haußmann_ and _Sebastian Bender_ until August, 2017.
It serves as the primary visualization dashboard for the [Brügger Lipidomics Group](https://bzh.db-engine.de/default.asp?lfn=2241&fg=4289) at the Heidelberg Biochemistry Center (BZH).
There is also a great deal of backend infrastructure, built by Mathias, to support a server with a database,
upload tools and a version of this App for internal use at the BZH.

## What changed?

In 2018 I started working on a new version of ShinyLipids. The idea is still very much based on the original,
but the internal coding and datastructure is designed to be more consistend and host a safer environment
for the implementation of new features within the R code. More information can be found on [my website](https://jmbuhr.de/project/shinylipids/).

## How do I use ShinyLipids?

Make sure you have the latest version of R installed. 
Then run this piece of R code to install ShinyLipds with all it's dependecies^[If you want to publish the ShinyApp on RStudio-connect, you will need a couple of addictional packages that
are listed in `app.R`.] from github:

```{r, eval=FALSE}
if ( !("devtools" %in% installed.packages()) ) install.packages("devtools")
devtools::install_github("jannikbuhr/ShinyLipids")
```

ShinyLipids gets the data it needs from a datbase.
This database needs to contain at least the two tables **id_info** and **data2** ^[the naming is due to backend compatibility].
Of course, you might not have your data in a database-dump file. To
get your tabular data (preferably _.csv_) into such a file, you can use a little helper
function in ShinyLipids:

```{r, eval=FALSE}
if ( !("readr" %in% installed.packages()) ) install.packages("readr")
myMedatdata <- readr::read_csv("myMetadata.csv")
myDataset   <- readr::read_csv("myDataset.csv")
ShinyLipids::createDatabase("./database/exampleDatabase.db", myMedatdata, myDataset)
```

Now you are ready to look at your lipids! Run this code for a quickstart:

```{r, eval=FALSE}
db_con <- DBI::dbConnect(RSQLite::SQLite(), "./database/exampleDatabase.db")
ShinyLipids::run_app(db = db_con)
```

### What should my tables look like?

**id_info**

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse, quietly = TRUE)
c("id" , "title " , "date_upload " , "status " , "sample_from " , "date_sample " , "extracted_by " , "date_extraction " , "measured_by " , "date_measured " , "distinct_samples " , "data_lines " , "file " , "instruments") %>%
  enframe(name = NULL, value = "Column") %>%
  knitr::kable()
```

**data2**

```{r, echo=FALSE, warning=FALSE, message=FALSE}
c("id" , "sample_identifier" , "lipid" , "category" , "func_cat" , "class" , "length" , "db" , "oh" , "chains" , "chain_sums" , "sample" , "sample_replicate" , "sample_replicate_technical" , "value") %>%
  enframe(name = NULL, value = "Column") %>%
  knitr::kable()
```

Optionally, your database can contain a table named "LIPID_CLASS_ORDER_COMPLETE" with
a numeric _class_order_ column associated with a _class_ column.
You can also reorder your lipid classes in the app on bottom of the main plotting page.

## For advanced use

If you want to run ShinyLipids on your own server connceted to a database
or post your findings to shinyapps.io, you will have to download the sourcecode:

```{bash, eval=FALSE}
git clone https://github.com/jannikbuhr/ShinyLipids.git
```

Open the file `app.R`, read the comments and uncomment the specified lines. Then you
will be able to run the app or use the buttons in the top right corner of your RStudio code panel.

## Notes

Please note that the 'ShinyLipids' project is released with a
[Contributor Code of Conduct](CODE_OF_CONDUCT.md).
By contributing to this project, you agree to abide by its terms.

